Hello World
===========

[必要な物のインストール](../0_install-requirements/README.md)が終わったら、アクセスすると*Hello World!*という文字が表示されるだけのシンプルなWebアプリケーションを作ってみます。

このステップで作成する[プログラムの完成版](./app.py)を用意してありますので、必要であれば参考にしてください。

## ともかくプログラムを書く
あなたのお気に入りのエディタを開いて、以下のプログラムを打ち込んでください。
``` python
import flask


app = flask.Flask(__name__)


@app.route('/')
def hello_world():
    return 'Hello World!'


if __name__ == '__main__':
    app.run()
```
完成したら、適当な名前を付けて保存してください。
ファイル名は何でも構いませんが、名前の最後は`.py`で終えてください。この拡張子は、それがPythonで書かれたプログラムを示すものです。

ここでは、`app.py`という名前で保存したものとして話を進めます。もしも違う名前を付けたのなら、適宜読み替えながら進めてください。

## 実行し、試してみる
プログラムを保存出来たら、さっそく実行してみます。
Pythonで書いたプログラムを実行するときは、ターミナルで以下のようなコマンドを打ちます。
``` bash
$ python3 app.py
```

もしも`app.py`以外の名前でファイルを保存したのなら、代わりにその名前を打ち込んでください。
また、今あなたが居るカレントディレクトリ以外にファイルを保存したのなら、そのディレクトリ名を含めて打ち込む必要があります。

また、Ubuntu以外の環境で試しているのなら、もしかしたら`python3`ではなく`python`と入力する必要があるかもしれません。これは環境によって変化しますので、適宜読み替えながら進めてください。

うまく実行出来れば、以下のような表示がされ、そのまま動かなくなるはずです。
```
$ python3 app.py
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
```
表示されている通り、CtrlとCを同時に押せばプログラムが停止します。
けれど今はそうせずに、ブラウザを開いて`http://localhost:5000`にアクセスしてみてください。
ブラウザは必ず、同じOS上で実行されているものを使用してください。もしも仮想マシン上でUbuntuを使用しているのなら、その仮想マシン上のブラウザを使用する必要があります。

もしも全て上手くいっているのなら、ブラウザに`Hello World!`と表示されたはずです。
これで、FlaskによるWebアプリを作ることが出来ました！

## 何が起ったのか
先程作成したプログラムが何をやったのか、逐一動きを追ってみることにします。（この節は少々退屈なので、読み飛ばして[次のステップ](../2_receive-data/README.md)に行ってしまっても問題ありません。）

### import flask
一番初めの行で、[Flask](http://flask.pocoo.org/)のインポートを行なっています。
これは、「Flaskというライブラリを使うよ」という宣言をしたということになります。

この講座の中でもいくつかのライブラリを使用しますが、その時は必ずプログラムの初めにこのインポートという宣言が書かれることになります。

ライブラリはPythonと一緒に配布されている**標準ライブラリ**と呼ばれているものと、Flaskのように個別に配布されている**サードパーティライブラリ**の二種類があります。（ちなみにこの名前を覚えても何の役にも立ちません。）
標準ライブラリにどんなものがあるのか知りたければ、[公式ドキュメントのリスト](http://docs.python.jp/3/library/index.html)をご覧になることをお勧めします。
このリストを見れば分かるように、標準ライブラリだけでもかなり色々なことを行なうことが出来ます。

### app = flask.Flask(\_\_name\_\_)
次に書いてあるのは、Flaskの初期化のために必要な処理です。
より厳密な言い方をすれば、「flaskモジュールに含まれるFlaskクラスのインスタンスを生成する」ということになるのですが、あまり気にする必要は無いような気がします。

必要なのは、ここで宣言されている`app`という変数を通してFlaskにアクセスすることになる、ということです。
このappはあなたがWebアプリケーションを作るために最低限必要な機能を提供してくれます。

### def hello\_world():
続く三行で、今回作成したWebアプリケーションの根幹である*Hello World!と表示する*という機能を実現しています。
``` python
@app.route('/')
def hello_world():
    return 'Hello World!'
```

最初の一行目は、次に定義する動作（**関数**と言います）にアクセスするためのアドレスを示しています。
今回は`'/'`なので、`http://localhost:5000/`でアクセスすることが出来ます。
もしもこれが`'/hello'`となっていれば、`http://localhost:5000/hello`でアクセスすることが出来るようになります。

真ん中の一行は、`hello_world`という名前の関数を定義するよ、ということを示しています。
`hello_world`以外の名前を付けても構いません。日本語の名前も付けられますが、キモチワルイので個人的にはお勧めしかねます。
すべて小文字で、単語と単語の間はアンダーバーで繋ぐのが[お行儀が良い](https://pep8-ja.readthedocs.io/ja/latest/)とされています。

最後の文は、ほとんど見た目通りの意味になります。すなわち、「'Hello World!'という文をクライアントに返却する」ということです。
Flaskを使用する場合（関数の頭に`@app.route`を付ける場合）は文字列しか返せませんが、`@app.route`を付けずに作った関数であれば数字やその他の物を返すことも出来ます。

行の初めにある空白はスペース4つにしておくのが[お行儀が良い](https://pep8-ja.readthedocs.io/ja/latest/)とされています。しかし、タブ文字一つにしたり、スペースの数を変えたりしても問題ありません。ただし、一つのプログラムの中では全て同じ方法で空間を開ける（**インデント**する と言います）ようにしてください。

#### 書き換えてみる
試しに、`'Hello World!'`をお好きな文章に書き換えてみてください。
プログラムを実行しなおしてブラウザで再読み込みしてみると、新しい文章が表示されるはずです。

もしも文章を書き換えたとき、`SyntaxError`云々というメッセージが出たら、おそらく両端にある`'`を消してしまったのだと思います。
二つの`'`は、その間にあるものが文字列であると示すための記号ですので、消してしまうと動作しません。ちなみに、`'`の代わりに`"`を使用することは出来ます。どちらも動作は変わりません。
このように、`SyntaxError`が表示されるということは、「文法的に正しくない記述が見付かった」というエラーであるということを覚えておいてください。

### app.run()
プログラムの最後の二行は、Flaskに内蔵されたWebサーバーを実行するためのコードです。
実際には`app.run()`という部分が引き金となってWebサーバーが動作するのですが、とても複雑な事情があってその前に`if __name__ == '__main__':`という記述が必要になっています。
これについてはここでは触れませんが、興味があれば調べるか聞くかしてください。

`app.run()`の代わりに、`app.run(debug=True)`と書くとサーバーがデバッグモードで立ち上がります。
デバッグモードで実行されているプログラムに問題が起こると、プログラム中のどこで問題が起こったのかを詳細に記したエラーメッセージが表示されます。
これはとても便利な機能ですが、同時にハッカーに便利なハッキングツールを提供することにもなってしまいます。ですので、あくまでテスト中にだけ使用するようにしましょう。

また、`app.run()`の代わりに`app.run(host='0.0.0.0')`と書けば、他のPCからでもあなたのWebアプリケーションにアクセスすることが出来るようになります。
他のPCからアクセスするときはIPアドレスやホスト名を使用します。

## 次になにをすれば良いか
いつも同じ表示が出るだけではWebアプリとは言い難いので（そして何よりつまらないので）、[次のステップ](../2_receive-data/README.md)でクライアントからの入力を受け取ってみることにしましょう。
